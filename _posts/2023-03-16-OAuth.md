---
title: "[Security] OAuth 2.0?"
date: '2023-03-16 +0900'
description: 'μΈμ¦ κ³µλ¶€ν•κΈ° - OAuth2.0'
categories: [Study,Security]
tags: [Network,Security]
---

> 3μ›” 3μ£Όμ°¨ μ¤ν„°λ”” λ°ν‘ μλ£π“–                                               
> **μ•μ μ„λ²„,ν† ν° μΈμ¦ ν¬μ¤ν…μ— μ΄μ–΄ OAuthμ— λ€ν•΄ μ•μ•„λ³΄κ³ μ ν•©λ‹λ‹¤!!**         
> π”¥**μ„λ²„/ν† ν° μΈμ¦λ°©μ‹:** <https://chonahyeon.github.io/posts/SessionToken/>{:target="_blank"}

## **OAuth?**
---
![μ†μ… λ΅κ·ΈμΈ](/assets/img/social-login.png){:style="border:0.2px solid ; border-radius: 6px; padding: 0px;" }
- OAuthλ€ **κµ¬κΈ€,νμ΄μ¤λ¶ λ“± λ‹¤μ–‘ν• ν”λ«νΌμ μ‚¬μ©μ λ°μ΄ν„°μ— μ ‘κ·Όν•κΈ° μ„ν•΄ μ  3μμΈ ν΄λΌμ΄μ–ΈνΈ(μ°λ¦¬μ μ„λΉ„μ¤)κ°€ μ‚¬μ©μμ μ ‘κ·Ό κ¶ν•μ„ μ„μ„λ°›μ„ μ μλ” ν”„λ΅ν† μ½μ΄λ‹¤.**
- μμ‹λ΅λ” ***μ†μ… λ΅κ·ΈμΈμ΄λ‚ κµ¬κΈ€ μΊλ¦°λ”μ™€ μ—°λ™ν•μ—¬ μ‚¬μ©μμ μΌμ •μ„ λ€μ‹  κΈ°λ΅ν•΄μ£Όλ” μ„λΉ„μ¤ λ“±μ΄ μλ‹¤.***

### **OAuth vs OAuth2.0**
- π¤” ***OAuthμ κ°λ…μ€ μ•κ² λ”λ° λ‘ λ²„μ „μ μ°¨μ΄λ” λ­κΉ?***     
    - **OAuth 2.0μ€ OAuthμ λ³΄μ• λ¬Έμ λ“±μ„ κ°μ„ ν• λ²„μ „μ΄λ‹¤.**
    - **OAuth 2.0μ€ μ•”νΈν™”μ™€ ν† ν° κ΄€λ¦¬κ°™μ€ μ¶”κ°€μ μΈ λ³΄μ• μ²λ¦¬λ¥Ό ν•„μ”λ΅ν•λ‹¤.**

|νΉμ§•|OAuth 1.0|OAuth 2.0|
|:---:|:---:|:---|
|***μ—­ν• ***|**μ΄μ©μ, μ†λΉ„μ, μ„λΉ„μ¤ μ κ³µμ**|**μμ› μ†μ μ, ν΄λΌμ΄μ–ΈνΈ, μμ› μ„λ²„, κ¶ν• μ„λ²„**|
|***API νΈμ¶ μΈμ¦ λ° λ³΄μ•***|**μ„λ…**|**- HTTPS κΈ°λ³Έ μ κ³µ**<br>- **Access Tokenμ λ§λ£μΌ μ„¤μ • κ°€λ¥**<br> - **μ—¬λ¬ μΈμ¦ λ°©μ‹μ„ μ κ³µν•¨μΌλ΅μ¨ λ‹¤μ–‘ν•**<br> **μ‹λ‚λ¦¬μ¤μ— λ€μ‘μ΄ κ°€λ¥ν•λ‹¤.**|
|***ν΄λΌμ΄μ–ΈνΈ μ§€μ› μ ν•***|**μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…**|**λ‹¤μ–‘ν• ν”λ«νΌ μ§€μ›**|
|***Access Token***|**Access Token λ°κΈ‰ μ‹ κ³„μ† μ‚¬μ© κ°€λ¥**|**λ³΄μ• κ°•ν™”λ¥Ό μ„ν•΄ λ§λ£μΌ μ„¤μ • κ°€λ¥**|

### **OAuth 2.0μ μ—­ν• **
1. **Resource Owner(μμ› μ†μ μ)**
    - **μμ› μ„λ²„μ— κ³„μ •μ„ κ°€μ§€κ³  μλ” μ‚¬μ©μλ΅ λ³ΈμΈμ κ³„μ •μ„ ν†µν•΄ μμ› μ„λ²„μ— μ ‘κ·Όν•λ” κ²ƒμ„ μΈκ°€ν•λ‹¤.**
2. **Client**
    - **Resource Serverμ μμ›μ„ μ΄μ©ν•κ³ μ ν•λ” μ• ν”λ¦¬μΌ€μ΄μ… (ex. μ†μ… λ΅κ·ΈμΈμ„ λ“±λ΅ν•κ³ μν•λ” μ•±,μ›Ή)**
3. **Resource Server(μμ› μ„λ²„)**
    - **νΉμ • μ‚¬μ©μμ λ¦¬μ†μ¤λ¥Ό κ°€μ§€κ³  μλ” μ„λ²„. (ex. κµ¬κΈ€,νΈμ„ν„°,νμ΄μ¤λ¶)**
4. **Authorization Server(μΈμ¦ μ„λ²„)**
    - ***μΈμ¦/μΈκ°€λ¥Ό μν–‰ν•λ” μ„λ²„***
    - **Clientμ—κ² λ³΄νΈλ μμ›μ— μ—‘μ„Έμ¤ ν•  μ μλ” κ¶ν•(Access Token)μ„ λ¶€μ—¬ν•΄μ¤€λ‹¤.**

### **OAuth 2.0μ λ™μ‘λ°©μ‹**
![OAuth μ‘λ™λ°©μ‹](/assets/img/oauth-flow2.png){:style="border:0.2px solid ; border-radius: 6px; padding: 0px; height: 500px;" }
- **OAuthμ λ€λµμ μΈ νλ¦„μ„ μ•μ•„λ³΄μ.**
1. ν΄λΌμ΄μ–ΈνΈλ” **λ³΄νΈλ λ¦¬μ†μ¤λ΅ μ ‘κ·Όν•κΈ° μ„ν•΄ μμ› μ†μ μμ—κ² κ¶ν•μ„ μ”μ²­ν•λ‹¤.**
2. μμ› μ†μ μκ°€ **λ¦¬μ†μ¤ μ ‘κ·Όμ— λ™μν•λ‹¤λ©΄ (μΈκ°€)**
3. **ν΄λΌμ΄μ–ΈνΈλ” μΈμ¦ μ„λ²„λ΅ Access Token λ°κΈ‰μ„ μ”μ²­ν•λ‹¤.** ***μ΄λ• μΈμ¦μ„ μ„ν• ν΄λΌμ΄μ–ΈνΈ μ •λ³΄μ™€ μ κ³µλ°›μ„ κ¶ν•μ„ ν•¨κ» μ „λ‹¬ν•λ‹¤.***
        - **Client ID** : ν΄λΌμ΄μ–ΈνΈλ¥Ό **μ‹λ³„ν•λ” κ³ μ ν• ID**
        - **Client Secret** : ν΄λΌμ΄μ–ΈνΈλ¥Ό **μΈμ¦ν•λ” λΉ„λ°€λ²νΈ κ°™μ€ κ°’**
        - **Scope** : μ κ³µλ°›μ„ **κ¶ν•μ λ²”μ„**λ¥Ό μ§€μ •
        - **Client Secret** : **Access Token λ°κΈ‰ μ™„λ£ ν›„ λ¦¬λ‹¤μ΄λ ‰νΈν•  URI**
4. **μΈμ¦ μ •λ³΄μ™€ μ κ³µν•  κ¶ν• μ •λ³΄κ°€ μ ν¨ν•λ‹¤λ©΄, μΈμ¦ μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ—κ² Access Tokenμ„ μ „λ‹¬ν•λ‹¤.**
5. ν΄λΌμ΄μ–ΈνΈλ” **μμ› μ„λ²„μ—κ² ν•„μ”ν• λ¦¬μ†μ¤λ¥Ό μ”μ²­ν•κ³  Access Tokenλ„ ν•¨κ» μ „λ‹¬ν•λ‹¤.**
6. μμ› μ„λ²„λ” **Access Tokenμ„ κ²€μ¦ν• ν›„, μ”μ²­ν• λ¦¬μ†μ¤λ¥Ό μ „λ‹¬ν•λ‹¤.**

## **OAuth 2.0μ κ¶ν• λ¶€μ—¬ μ ν•**
> **μ΄λ―Έμ§€ μ¶μ² [κ¶ν• λ¶€μ—¬ μ„ νƒ μ ν• ]:** <https://m.blog.naver.com/PostView.naver?blogId=mds_datasecurity&logNo=222182943542&proxyReferer=>{:target="_blank"}      
> **μ΄λ―Έμ§€ μ¶μ² [κ¶ν• λ¶€μ—¬ μ„ νƒ flow ]:** <https://justee.tistory.com/1>{:target="_blank"}  

- ***κ¶ν•λ¶€μ—¬?***       
**ν΄λΌμ΄μ–ΈνΈκ°€ μ‚¬μ©μ(μμ› μ†μ μ)λ¥Ό λ€μ‹ ν•μ—¬ μ‚¬μ©μμ μΉμΈ ν•μ— μΈκ°€μ„λ²„λ΅ λ¶€ν„° κ¶ν•μ„ λ¶€μ—¬λ°›λ” κ²ƒ**

### **1. Authorization Code**
- κ¶ν• μ½”λ“ λ¶€μ—¬νƒ€μ…μ΄λ©° **μ„λ²„ μ‚¬μ΄νΈ μ• ν”λ¦¬μΌ€μ΄μ…(μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…)μ— μ ν•©ν•λ©° λ³΄μ•μ— κ°€μ¥ μ•μ „ν• μ ν•μ΄λ‹¤.**
- λ¦¬μ†μ¤ μ ‘κ·Όμ„ μ„ν• **μ‚¬μ©μ λ…κ³Ό λΉ„λ°€λ²νΈ, κ¶ν• μ„λ²„μ— μ”μ²­ν•΄μ„ λ°›μ€ κ¶ν• μ½”λ“λ¥Ό ν•¨κ» ν™μ©ν•μ—¬ λ¦¬μ†μ¤μ— λ€ν• μ—‘μ„Έμ¤ ν† ν°μ„ λ°›λ”λ‹¤.**
- ***Refresh Tokenμ μ‚¬μ©μ΄ κ°€λ¥ν•λ‹¤.***

![κ¶ν• λ¶€μ—¬ νƒ€μ… 1](/assets/img/authorization-code-grant.png){:style="border:0.2px solid ; border-radius: 6px; padding: 0px;" }
1. ν΄λΌμ΄μ–ΈνΈκ°€ **κ¶ν• μ½”λ“λ¥Ό μ–»κΈ° μ„ν•΄ νλΌλ―Έν„°λ΅ ν΄λΌμ΄μ–ΈνΈ ID, λ¦¬λ‹¤μ΄λ ‰νΈ URI, μ‘λ‹µ νƒ€μ…μ„ Codeλ΅ μ§€μ •ν•μ—¬ κ¶ν• μ„λ²„μ— μ „λ‹¬ν•λ‹¤.**
2. κ¶ν• μ„λ²„λ” **μ‚¬μ©μ(Resource Owner)μ—κ² λ΅κ·ΈμΈ νμ΄μ§€λ¥Ό μ κ³µν•κ³  ν•΄λ‹Ή νμ΄μ§€λ¥Ό ν†µν•΄ μ‚¬μ©μμ μΈμ¦μ΄ μ™„λ£λλ©΄ κ¶ν• μ½”λ“λ¥Ό redirect_urlλ΅ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „λ‹¬ν•λ‹¤.**
3. κ¶ν• μ½”λ“λ¥Ό μ „λ‹¬ λ°›μ€ ν›„ **ν΄λΌμ΄μ–ΈνΈλ” κ¶ν• μ½”λ“λ¥Ό μ‚¬μ©ν•μ—¬ κ¶ν• μ„λ²„μ— Access Tokenμ„ μ¶”κ°€λ΅ μ”μ²­ν•λ‹¤.** μ΄λ• νλΌλ―Έν„°λ΅ **ν΄λΌμ΄μ–ΈνΈ μ•„μ΄λ””, ν΄λΌμ΄μ–ΈνΈ λΉ„λ°€λ²νΈ, λ¦¬λ‹¤μ΄λ ‰νΈ URI,μΈμ¦ νƒ€μ…μ΄ ν•„μ”ν•λ‹¤.**
4. **Access Tokenμ„ μ „λ‹¬ λ°›μ€ ν›„ λ¦¬μ†μ¤ μ„λ²„μ— μ—‘μ„Έμ¤ ν† ν°μ„ μ‚¬μ©ν•μ—¬ ν•„μ”ν• λ¦¬μ†μ¤λ¥Ό μ”μ²­ν•λ‹¤.**

### **2. Implict**
- μ•”μ‹μ  μΉμΈ νƒ€μ…μ΄λ©° **κ¶ν• μ½”λ“ μ—†μ΄ λ°”λ΅ Access Tokenμ΄ λ°κΈ‰λλ” λ°©μ‹μ΄λ‹¤.**
- **μκ²© μ¦λ…μ„ μ•μ „ν•κ² μ €μ¥ν•κΈ° νλ“  ν΄λΌμ΄μ–ΈνΈμ—κ² μµμ ν™”λ λ°©μ‹μ΄λ‹¤. (ex.μ¤ν¬λ¦½νΈ μ–Έμ–΄λ¥Ό μ‚¬μ©ν• λΈλΌμ°μ €)**
- **Access Tokenμ λ§λ£κΈ°κ°„μ„ μ§§κ² μ„¤μ •ν•μ—¬ μ™Έλ¶€ μ μ¶μ μ„ν—μ„ μ¤„μ—¬μ•Όν•λ‹¤.**

![κ¶ν• λ¶€μ—¬ νƒ€μ… 2](/assets/img/implict.png){:style="border:0.2px solid ; border-radius: 6px; padding: 0px;" }
1. ν΄λΌμ΄μ–ΈνΈκ°€ **μ ‘κ·Ό κ¶ν•μ„ μ–»κΈ° μ„ν•΄ νλΌλ―Έν„°λ΅ ν΄λΌμ΄μ–ΈνΈ ID, λ¦¬λ‹¤μ΄λ ‰νΈ URI, μ‘λ‹µ νƒ€μ…μ„ tokenμΌλ΅ μ§€μ •ν•μ—¬ κ¶ν• μ„λ²„μ— μ „λ‹¬ν•λ‹¤.** 
2. κ¶ν• μ„λ²„λ” **μ‚¬μ©μ(Resource Owner)μ—κ² λ΅κ·ΈμΈ νμ΄μ§€λ¥Ό μ κ³µν•κ³  ν•΄λ‹Ή νμ΄μ§€λ¥Ό ν†µν•΄ μ‚¬μ©μμ μΈμ¦μ΄ μ™„λ£λλ©΄ Access Tokenμ„ redirect_urlλ΅ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „λ‹¬ν•λ‹¤.**
    - ***Authorization Codeμ™€ λ‹¬λ¦¬ Implict λ°©μ‹μ€ κ¶ν• μ½”λ“λ¥Ό λ¶€μ—¬λ°›μ§€ μ•κ³  λ°”λ΅ Access Tokenμ΄ λ°κΈ‰λλ‹¤.***
    - **λ¦¬μ†μ¤ μ†μ μμ μΈμ¦ μ •λ³΄λ¥Ό ν΄λΌμ΄μ–ΈνΈμ—μ„ μ§μ ‘ κ°€μ§€κ³  μλ”λ‹¤.**
3. **Access Tokenμ„ ν†µν•΄ λ¦¬μ†μ¤ μ„λ²„μ— ν•„μ”ν• λ¦¬μ†μ¤λ¥Ό μ”μ²­ν•λ‹¤.**
4. **Access Tokenμ΄ μ ν¨ν•λ‹¤λ©΄ μ”μ²­ν• λ¦¬μ†μ¤λ¥Ό μ „λ‹¬ν•λ‹¤.**

### **3. Resource Owner Password Credentials**
- μμ›μ„λ²„μ— **κ³„μ •μ΄ μλ” μ‚¬μ©μμ μ•„μ΄λ””, ν¨μ¤μ›λ“λ¥Ό ν†µν•΄ Access Tokenμ„ λ°κΈ‰λ°›λ” λ°©μ‹.**
- ***ν΄λΌμ΄μ–ΈνΈκ°€ νƒ€μ‚¬μ μ™Έλ¶€ ν”„λ΅κ·Έλ¨μ΄λΌλ©΄ μ λ€ μ΄ λ°©μ‹μ„ μ‚¬μ©ν•΄μ„λ” μ•λλ‹¤.***       
**μ¦‰, κ¶ν• μ„λ²„,λ¦¬μ†μ¤ μ„λ²„,ν΄λΌμ΄μ–ΈνΈκ°€ λ¨λ‘ κ°™μ€ μ‹μ¤ν…μ— μ†ν•΄ μμ„ λ• μ‚¬μ©ν•΄μ•Όν•λ” λ°©μ‹μ΄λ‹¤.**      
- **Refresh Token μ‚¬μ©μ΄ κ°€λ¥ν•λ‹¤.**

![κ¶ν• λ¶€μ—¬ νƒ€μ… 3](/assets/img/resource-owner.png){:style="border:0.2px solid ; border-radius: 6px; padding: 0px;" }
1. μ‚¬μ©μ(λ¦¬μ†μ¤ μ†μ μ)κ°€ **ν΄λΌμ΄μ–ΈνΈμ—κ² μ„λΉ„μ¤ μ‚¬μ© μ”μ²­ μ‹, λ¦¬μ†μ¤ μ„λ²„μ μ•„μ΄λ””μ™€ λΉ„λ°€λ²νΈλ¥Ό κ°™μ΄ μ „μ†΅ν•λ‹¤.**
2. ν΄λΌμ΄μ–ΈνΈλ” **μ‚¬μ©μμ λ¦¬μ†μ¤ μ„λ²„ μ•„μ΄λ””μ™€ λΉ„λ°€λ²νΈλ¥Ό μ‚¬μ©ν•μ—¬ Access Tokenμ„ μ”μ²­ν•λ‹¤. νλΌλ―Έν„°λ΅ ν΄λΌμ΄μ–ΈνΈ ID, ν΄λΌμ΄μ–ΈνΈ μ‹ν¬λ¦Ώ ν‚¤, μΉμΈ νƒ€μ…, μ‚¬μ©μμ ID, μ‚¬μ©μμ Passwordλ¥Ό κ¶ν• μ„λ²„μ— μ „λ‹¬ν•λ‹¤.**
3. ν΄λΌμ΄μ–ΈνΈλ” **Access Tokenμ„ ν†µν•΄ λ¦¬μ†μ¤ μ„λ²„μ— ν•„μ”ν• λ¦¬μ†μ¤λ¥Ό μ”μ²­ν•λ‹¤.**

### **4. Client Credentials**
- ν΄λΌμ΄μ–ΈνΈ μκ²© μ¦λ… μΉμΈνƒ€μ…μΌλ΅ **ν΄λΌμ΄μ–ΈνΈμ μκ²© μ¦λ…λ§μΌλ΅ Access Tokenμ„ νλ“ν•λ” λ°©μ‹μ΄λ‹¤.**
- μ¦‰, ***ν΄λΌμ΄μ–ΈνΈ μ• ν”λ¦¬μΌ€μ΄μ… μμ²΄κ°€ μμ›μ— λ€ν• μ ‘κ·Ό κ¶ν•μ„ κ°€μ§€κ³  μμ„ λ• μ‚¬μ©ν•λ” λ°©μ‹μΌλ΅ μ‚¬μ©μ μΈμ¦μ΄ λ¶ν•„μ”ν•λ‹¤.***
- **μ„λ²„κ°„ ν†µμ‹ μ„ μ„ν• μΈμ¦μ— μ£Όλ΅ μ‚¬μ©ν•λ‹¤.**
- **Refresh Token μ‚¬μ©μ΄ λ¶κ°€λ¥ν•λ‹¤.**      

![κ¶ν• λ¶€μ—¬ νƒ€μ… 4](/assets/img/client-credentials.png){:style="border:0.2px solid ; border-radius: 6px; padding: 0px;" }
1. ν΄λΌμ΄μ–ΈνΈκ°€ λ³ΈμΈμ **ν΄λΌμ΄μ–ΈνΈ IDμ™€ μ‹ν¬λ¦Ών‚¤λ¥Ό ν†µν•΄ Access Tokenμ„ μ”μ²­ν•λ‹¤.**
2. κ¶ν• μ„λ²„λ” **μ ν¨ν• IDμ™€ μ‹ν¬λ¦Ώ ν‚¤ κ°’μ΄λ©΄ Access Tokenμ„ λ°κΈ‰ν•λ‹¤.**
3. ν΄λΌμ΄μ–ΈνΈλ” **Access Tokenμ„ ν†µν•΄ λ¦¬μ†μ¤ μ„λ²„μ— ν•„μ”ν• λ¦¬μ†μ¤λ¥Ό μ”μ²­ν•λ‹¤.**

### π¤” **κ¶ν• λ¶€μ—¬ μ ν•μ€ μ–΄λ–»κ² μ„ νƒν• κΉ?**
![κ¶ν• λ¶€μ—¬ μ ν•](/assets/img/auth-type.png){:style="border:0.2px solid ; border-radius: 6px; padding: 0px;" }
- **First party?**
    - **μ†ν”„νΈμ›¨μ–΄ λλ” IT μ„λΉ„μ¤λ¥Ό μ§μ ‘ κ°λ°ν•κ³  μ΄μν•λ” μ£Όμ²΄**
    - **λ°μ΄ν„°λ¥Ό μ κ³µν•λ” μΈ΅μ„ λ§ν•λ©° λ§μ•½ κµ¬κΈ€ κ³„μ •μΌλ΅ Gmailμ— λ΅κ·ΈμΈ ν•  κ²½μ° κµ¬κΈ€μ΄ First Partyμ΄λ‹¤.**
- **Third party?**
    - **μ›λμ μ κ³µμκ°€ μ•„λ‹ μ™Έλ¶€μ—μ„ μ κ³µλλ” μ„λΉ„μ¤λ‚ μ• ν”λ¦¬μΌ€μ΄μ…μ„ λ§ν•λ‹¤.**
    - **λ°μ΄ν„°λ¥Ό μμ§‘ν•κ±°λ‚ μ²λ¦¬ν•λ” μΈ΅μ„ λ§ν•λ‹¤.**
    - **μλ¥Ό λ“¤μ–΄ νƒ€ μ‚¬μ΄νΈμ—μ„ Facebookμ„ ν†µν•΄ λ΅κ·ΈμΈ ν•  κ²½μ° Facebookμ€ Third partyμ΄λ‹¤.**
